<ImportExportXml xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Entities></Entities>
  <Roles></Roles>
  <Workflows>
    <Workflow WorkflowId="{b43cfa70-3d2e-4799-a975-14fc80b1f5b0}" Name="RPA-710-CRMDeletion">
      <JsonFileName>/Workflows/RPA-710-CRMDeletion-B43CFA70-3D2E-4799-A975-14FC80B1F5B0.json</JsonFileName>
      <Type>1</Type>
      <Subprocess>0</Subprocess>
      <Category>6</Category>
      <Mode>0</Mode>
      <Scope>4</Scope>
      <OnDemand>0</OnDemand>
      <TriggerOnCreate>0</TriggerOnCreate>
      <TriggerOnDelete>0</TriggerOnDelete>
      <AsyncAutodelete>0</AsyncAutodelete>
      <SyncWorkflowLogOnFailure>0</SyncWorkflowLogOnFailure>
      <StateCode>1</StateCode>
      <StatusCode>2</StatusCode>
      <RunAs>1</RunAs>
      <IsTransacted>1</IsTransacted>
      <IntroducedVersion>1.0</IntroducedVersion>
      <IsCustomizable>1</IsCustomizable>
      <BusinessProcessType>0</BusinessProcessType>
      <UIFlowType>2</UIFlowType>
      <IsCustomProcessingStepAllowedForOtherPublishers>1</IsCustomProcessingStepAllowedForOtherPublishers>
      <Metadata>{"isvalid":true,"schemaVersion":"ROBIN_20211012","containsActiveConnections":false}</Metadata>
      <Inputs>{"schema":{"properties":{"Environment":{"default":"","description":"Holds environment specific values - DEV, QA, PROD","format":null,"title":"Environment","type":"string","value":"DEV"},"Config_SAPPassword":{"default":"","description":"SAP Credentials","format":"password","title":"Config_SAPPassword","type":"string","value":null},"Config_SAPUsername":{"default":"","description":"","format":"password","title":"Config_SAPUsername","type":"string","value":null}},"type":"object"}}</Inputs>
      <Outputs>{"schema":{"properties":{"UsersList":{"default":"","description":"","format":null,"title":"UsersList","type":"string","value":null},"NumberOfRecordsFound":{"default":"","description":"","format":null,"title":"NumberOfRecordsFound","type":"number","value":null}},"type":"object"}}</Outputs>
      <Dependencies>{"childFlows":[]}</Dependencies>
      <ConnectionReferences>[]</ConnectionReferences>
      <Definition>"@@ConnectionString: ''\r\n@@Type: 'Local'\r\n@@DesktopType: 'local'\r\n@@DisplayName: 'Local computer'\r\nIMPORT 'controlRepo.appmask' AS appmask\r\nIMPORT 'imageRepo.imgrepo' AS imgrepo\r\n@SENSITIVE: [Config_SAPPassword, Config_SAPUsername]\r\n@INPUT Environment : { 'Description': 'Holds environment specific values - DEV, QA, PROD', 'FriendlyName': 'Environment', 'DefaultValue': 'DEV', 'Type': 'String' } \r\n@OUTPUT UsersList : { 'Description': '', 'FriendlyName': 'UsersList', 'Type': 'String' } \r\n@INPUT Config_SAPPassword : { 'Description': 'SAP Credentials', 'FriendlyName': 'Config_SAPPassword', 'DefaultValue': 'Tr!2%t*:/?HgV7I6+Mo', 'Type': 'String' } \r\n@OUTPUT NumberOfRecordsFound : { 'Description': '', 'FriendlyName': 'NumberOfRecordsFound', 'Type': 'Numeric' } \r\n@INPUT Config_SAPUsername : { 'Description': '', 'FriendlyName': 'Config_SAPUsername', 'DefaultValue': 'RR858924', 'Type': 'String' } \r\n# Main task for Nova Archive\r\nSET EmailMessage TO $'''Please find the attached users list who have left the organisation, kindly delete the users from the REV-TRAC Change Management System and change owner list.\r\n'''\r\nBLOCK MainBlockErrorHandler\r\nON BLOCK ERROR all\r\n    SET ErrorHandlerMessage TO $'''Flow failed due to some error'''\r\n    CALL ErrorHandler\r\n    THROW ERROR\r\nEND\r\n    CALL Configuration\r\n    CALL SAPLogin\r\n    CALL ExportUsersFromSAP\r\n    CALL SAPUsersData\r\n    CALL LeaversData\r\n    CALL IterateOverLeaversData\r\n    IF NumberOfRecordsFound &gt; 0 THEN\r\n        CALL WriteResultsToExcel\r\n        CALL SendEmailNotification\r\n    ELSE\r\n        SET EmailMessage TO $'''The given users is not available in the report downloaded from SAP.'''\r\n        CALL SendEmailNotification\r\n    END\r\nEND\r\nFUNCTION Configuration GLOBAL\r\n    # Reading/Setting Config variables\r\n    SET Config_FolderPath TO $'''C:\\\\Users\\\\ds575852\\\\OneDrive - GSK\\\\Projects\\\\Power Automate\\\\PoC\\\\TEC_OPS_005_CRM_Delete\\\\Folder Structure'''\r\n    SET Config_SAPLogonEXEPath TO $'''C:\\\\Program Files (x86)\\\\SAP\\\\FrontEnd\\\\SAPgui\\\\saplogon.exe'''\r\n    SET Config_MaxDelay TO 60\r\n    CALL Encryption\r\nEND FUNCTION\r\nFUNCTION ErrorHandler GLOBAL\r\n    ERROR =&gt; LastError\r\n    UIAutomation.CloseWindow.CloseByTitleClass Title: $'''SAP Easy Access*''' Class: $'''SAP_FRONTEND_SESSION'''\r\n    ON ERROR\r\n\r\n    END\r\n    UIAutomation.CloseWindow.CloseByTitleClass Title: $'''SAP Logon 760''' Class: $'''#32770'''\r\n    ON ERROR\r\n\r\n    END\r\nEND FUNCTION\r\nFUNCTION SAPLogin GLOBAL\r\n    # This task will login to the SAP and only return control when the login in complete.\r\n    System.RunApplication.RunApplicationAndWaitToLoad ApplicationPath: Config_SAPLogonEXEPath WindowStyle: System.ProcessWindowStyle.Normal Timeout: Config_MaxDelay ProcessId=&gt; AppProcessId WindowHandle=&gt; WindowHandle\r\n    UIAutomation.Click Element: appmask['Window \\'SAP Logon 760\\'']['Edit \\'Filter:\\''] ClickType: UIAutomation.ClickType.LeftClick MousePositionRelativeToElement: UIAutomation.RectangleEdgePoint.MiddleCenter OffsetX: 0 OffsetY: 0\r\n    WAIT 1\r\n    MouseAndKeyboard.SendKeys.FocusAndSendKeys TextToSend: $'''RSP-SAP''' DelayBetweenKeystrokes: 10 SendTextAsHardwareKeys: False\r\n    UIAutomation.Click Element: appmask['Window \\'SAP Logon 760\\'']['Text \\'1.B - RSP-SAP Solution Manager\\''] ClickType: UIAutomation.ClickType.DoubleClick MousePositionRelativeToElement: UIAutomation.RectangleEdgePoint.MiddleCenter OffsetX: 0 OffsetY: 0\r\n    WAIT (UIAutomation.WaitForWindowContent.WindowToContainElement Element: appmask['Window \\'SAP\\'']['Gui Text Field \\'RSYST-BNAME\\''])\r\n    UIAutomation.Click Element: appmask['Window \\'SAP\\'']['Gui Text Field \\'RSYST-BNAME\\''] ClickType: UIAutomation.ClickType.LeftClick MousePositionRelativeToElement: UIAutomation.RectangleEdgePoint.MiddleCenter OffsetX: 0 OffsetY: 0\r\n    MouseAndKeyboard.SendKeys.FocusAndSendKeys TextToSend: $'''%Config_SAPUsername%{Tab}''' DelayBetweenKeystrokes: 10 SendTextAsHardwareKeys: False\r\n    DISABLE UIAutomation.Click Element: appmask['Window \\'SAP\\'']['Gui Password Field \\'RSYST-BCODE\\''] ClickType: UIAutomation.ClickType.LeftClick MousePositionRelativeToElement: UIAutomation.RectangleEdgePoint.MiddleCenter OffsetX: 0 OffsetY: 0\r\n    MouseAndKeyboard.SendKeys.FocusAndSendKeys TextToSend: $'''%Config_SAPPassword%{Return}''' DelayBetweenKeystrokes: 10 SendTextAsHardwareKeys: False\r\n    DISABLE WAIT (UIAutomation.WaitForWindow.ToOpen Window: appmask['Window \\'SAP Easy  ... y Robot-EO\\''] FocusWindow: False)\r\n    WAIT (UIAutomation.WaitForWindowContent.WindowToContainElement Element: appmask['Window \\'SAP Easy  ... y Robot-EO\\'']['Pane \\'SAP\\'s Advanced Treelist\\''])\r\nEND FUNCTION\r\nFUNCTION IterateOverLeaversData GLOBAL\r\n    SET UsersList TO $'''%%'''\r\n    Variables.CreateNewDatatable InputTable: { ^['Column1', 'Column2', 'Column3', 'Column4', 'Column5', 'Column6', 'Column7'], [$'''''', $'''''', $'''''', $'''''', $'''''', $'''''', $''''''] } DataTable=&gt; Results\r\n    SET NumberOfRecordsFound TO 0\r\n    LOOP FOREACH CurrentLeaver IN LeaversData\r\n        IF IsNotEmpty(CurrentLeaver[2]) THEN\r\n            IF CurrentLeaver[2] &lt;&gt; $'''UserID''' THEN\r\n                Variables.FindOrReplaceInDataTable.FindItemInDataTableByColumnIndex DataTable: UsersData AllMatches: True ValueToFind: CurrentLeaver[2] MatchCase: False MatchEntireCellContents: True ColumnNameOrIndex: 3 DataTableMatches=&gt; DataTableMatches\r\n                IF DataTableMatches.RowsCount &gt;= 1 THEN\r\n                    Variables.IncreaseVariable Value: NumberOfRecordsFound IncrementValue: 1\r\n                    DISABLE Display.ShowMessageDialog.ShowMessage Title: $'''CL''' Message: $'''%CurrentLeaver[2]%.\r\n%DataTableMatches[0][0]%''' Icon: Display.Icon.None Buttons: Display.Buttons.OK DefaultButton: Display.DefaultButton.Button1 IsTopMost: False ButtonPressed=&gt; ButtonPressed\r\n                    DISABLE Variables.AddRowToDataTable.AppendRowToDataTable DataTable: Results RowToAdd: UsersData[DataTableMatches[0][0]]\r\n                    SET RowFound TO DataTableMatches[0][0]\r\n                    Variables.AddRowToDataTable.AppendRowToDataTable DataTable: Results RowToAdd: UsersData[RowFound + 0]\r\n                    Text.AppendLine Text: CurrentLeaver[2] LineToAppend: UsersList Result=&gt; UsersList\r\n                END\r\n            END\r\n        END\r\n    END\r\nEND FUNCTION\r\nFUNCTION LeaversData GLOBAL\r\n    Excel.LaunchExcel.LaunchAndOpenUnderExistingProcess Path: $'''%Config_FolderPath%\\\\Input\\\\Leavers File\\\\Leavers File.xlsx''' Visible: True ReadOnly: False Instance=&gt; LeaversFileInstance\r\n    Excel.ReadFromExcel.ReadAllCells Instance: LeaversFileInstance ReadAsText: False FirstLineIsHeader: False RangeValue=&gt; LeaversData\r\n    Excel.CloseExcel.Close Instance: LeaversFileInstance\r\nEND FUNCTION\r\nFUNCTION SAPUsersData GLOBAL\r\n    Excel.LaunchExcel.LaunchAndOpenUnderExistingProcess Path: $'''%Config_FolderPath%\\\\Output\\\\export.xlsx''' Visible: True ReadOnly: False Instance=&gt; ExcelInstance\r\n    Excel.ReadFromExcel.ReadAllCells Instance: ExcelInstance ReadAsText: False FirstLineIsHeader: False RangeValue=&gt; UsersData\r\n    Excel.CloseExcel.Close Instance: ExcelInstance\r\nEND FUNCTION\r\nFUNCTION WriteResultsToExcel GLOBAL\r\n    Excel.LaunchExcel.LaunchUnderExistingProcess Visible: True Instance=&gt; ResultsFileInstance\r\n    Excel.WriteToExcel.Write Instance: ResultsFileInstance Value: Results\r\n    Excel.CloseExcel.CloseAndSaveAs Instance: ResultsFileInstance DocumentFormat: Excel.ExcelFormat.FromExtension DocumentPath: $'''%Config_FolderPath%\\\\Output\\\\Results.xlsx'''\r\nEND FUNCTION\r\nFUNCTION SendEmailNotification GLOBAL\r\n    SET EmailMessage TO $'''Please find the attached users list who have left the organisation, kindly delete the users from the REV-TRAC Change Management System and change owner list.\r\n'''\r\n    Outlook.Launch Instance=&gt; OutlookInstance\r\n    Outlook.SendEmailThroughOutlook.SendEmail Instance: OutlookInstance Account: $'''dipendra.x.shekhawat@gsk.com''' SendTo: $'''dipendra.x.shekhawat@gsk.com''' Subject: $'''Deletion of users from the REV-TRAC Change Management System''' Body: $'''Hi Team,\r\n\r\n%EmailMessage%\r\n\r\nRegards\r\nRPA Bot''' IsBodyHtml: False Attachments: $'''%Config_FolderPath%\\\\Output\\\\Results.xlsx'''\r\n    Outlook.Close Instance: OutlookInstance\r\nEND FUNCTION\r\nFUNCTION ExportUsersFromSAP GLOBAL\r\n    # Delete exported file from previous run\r\n    File.Delete Files: $'''%Config_FolderPath%\\\\Output\\\\export.xlsx'''\r\n    ON ERROR\r\n\r\n    END\r\n    # Performing SAP transaction to export the list of users from SAP.l\r\n    Scripting.RunVBScript VBScriptCode: $'''If Not IsObject(application) Then\r\n   Set SapGuiAuto  = GetObject(\\\"SAPGUI\\\")\r\n   Set application = SapGuiAuto.GetScriptingEngine\r\nEnd If\r\nIf Not IsObject(connection) Then\r\n   Set connection = application.Children(0)\r\nEnd If\r\nIf Not IsObject(session) Then\r\n   Set session    = connection.Children(0)\r\nEnd If\r\nIf IsObject(WScript) Then\r\n   WScript.ConnectObject session,     \\\"on\\\"\r\n   WScript.ConnectObject application, \\\"on\\\"\r\nEnd If\r\nsession.findById(\\\"wnd[0]\\\").maximize\r\nsession.findById(\\\"wnd[0]/usr/cntlIMAGE_CONTAINER/shellcont/shell/shellcont[0]/shell\\\").topNode = \\\"0000000019\\\"\r\nsession.findById(\\\"wnd[0]/usr/cntlIMAGE_CONTAINER/shellcont/shell/shellcont[0]/shell\\\").doubleClickNode \\\"0000000063\\\"\r\nsession.findById(\\\"wnd[0]/mbar/menu[2]/menu[2]/menu[2]\\\").select\r\nsession.findById(\\\"wnd[0]/shellcont/shell\\\").selectItem \\\"05\\\",\\\"Column1\\\"\r\nsession.findById(\\\"wnd[0]/shellcont/shell\\\").ensureVisibleHorizontalItem \\\"05\\\",\\\"Column1\\\"\r\nsession.findById(\\\"wnd[0]/shellcont/shell\\\").doubleClickItem \\\"05\\\",\\\"Column1\\\"\r\nsession.findById(\\\"wnd[1]\\\").sendVKey 4\r\nsession.findById(\\\"wnd[2]/usr/lbl[1,3]\\\").caretPosition = 3\r\nsession.findById(\\\"wnd[2]\\\").sendVKey 2\r\nsession.findById(\\\"wnd[1]/tbar[0]/btn[0]\\\").press\r\nsession.findById(\\\"wnd[0]\\\").sendVKey 86\r\nsession.findById(\\\"wnd[0]/tbar[1]/btn[43]\\\").press\r\n\\'session.findById(\\\"wnd[1]/usr/ctxtDY_FILENAME\\\").text = \\\"export1XLSX\\\"\r\n\\'session.findById(\\\"wnd[1]/usr/ctxtDY_FILENAME\\\").caretPosition = 7\r\n\\'session.findById(\\\"wnd[1]/tbar[0]/btn[0]\\\").press\r\nsession.findById(\\\"wnd[1]/usr/ctxtDY_PATH\\\").text = \\\"C:\\\\Users\\\\ds575852\\\\OneDrive - GSK\\\\Projects\\\\Power Automate\\\\PoC\\\\TEC_OPS_005_CRM_Delete\\\\Folder Structure\\\\Output\\\\\\\"\r\nsession.findById(\\\"wnd[1]/usr/ctxtDY_FILENAME\\\").text = \\\"export.xlsx\\\"\r\nsession.findById(\\\"wnd[1]/usr/ctxtDY_FILENAME\\\").caretPosition = 11\r\nsession.findById(\\\"wnd[1]/tbar[0]/btn[0]\\\").press\r\nsession.findById(\\\"wnd[0]/tbar[0]/btn[15]\\\").press\r\nsession.findById(\\\"wnd[0]/tbar[0]/btn[15]\\\").press\r\nsession.findById(\\\"wnd[0]/tbar[0]/btn[15]\\\").press''' ScriptOutput=&gt; VBScriptOutput\r\n    # Closing SAP windows\r\n    UIAutomation.CloseWindow.CloseByTitleClass Title: $'''SAP Easy Access*''' Class: $'''SAP_FRONTEND_SESSION'''\r\n    UIAutomation.CloseWindow.CloseByTitleClass Title: $'''SAP Logon 760''' Class: $'''#32770'''\r\n    # Closing Excel that is opened while exporting from SAP.\r\n    UIAutomation.CloseWindow.CloseByTitleClass Title: $'''export.xlsx - Excel''' Class: $'''XLMAIN'''\r\nEND FUNCTION\r\nFUNCTION Encryption GLOBAL\r\n    DISABLE Cryptography.EncryptText.EncryptTextWithAES Encoding: Cryptography.EncryptionEncoding.Unicode TextToEncrypt: Config_SAPPassword EncryptionKey: P'AQAAANCMnd8BFdERjHoAwE/Cl+sBAAAAVpMHgWkIL0OIeUH6dmgkBwQAAAACAAAAAAADZgAAwAAAABAAAADGk5XI+qmwiTAgopPms25IAAAAAASAAACgAAAAEAAAAOWWcei2s7xwyxjAiXCYSQcgAAAAri3oc1TXJtQanEDrUxnUxuFM8pPwiPsmhTwIm5MfgK4UAAAAb9ryP09lzG4HSWsoNz7gJMy0bWs=' PaddingMode: Cryptography.PaddingMode.PKCS7 KeySize: Cryptography.AESKeySize.Bits256 EncryptedText=&gt; EncryptedText\r\n    Cryptography.DecryptText.DecryptTextWithAES Encoding: Cryptography.EncryptionEncoding.Unicode TextToDecrypt: Config_SAPPassword DecryptionKey: P'AQAAANCMnd8BFdERjHoAwE/Cl+sBAAAAVpMHgWkIL0OIeUH6dmgkBwQAAAACAAAAAAADZgAAwAAAABAAAACsiApJDENOLDYuBZIPd85+AAAAAASAAACgAAAAEAAAAHBhsgWpIXwlSrpx1xoJD4sgAAAAWnbZuDPzQO9l2uOdJfZT/MeIxZw+vmCAmkfoJqWKB4AUAAAA2vj9fklT2zy9ib1kjy9HJVDx11Q=' Padding: Cryptography.PaddingMode.PKCS7 KeySize: Cryptography.AESKeySize.Bits256 DecryptedText=&gt; Config_SAPPassword\r\nEND FUNCTION\r\n"</Definition>
      <SchemaVersion>2022.06</SchemaVersion>
      <PrimaryEntity>none</PrimaryEntity>
      <LocalizedNames>
        <LocalizedName languagecode="1033" description="RPA-710-CRMDeletion" />
      </LocalizedNames>
    </Workflow>
    <Workflow WorkflowId="{dea96a09-57b3-435b-9ae5-ba4bb5a28171}" Name="RPA-3021-NovaArchive">
      <JsonFileName>/Workflows/RPA-3021-NovaArchive-DEA96A09-57B3-435B-9AE5-BA4BB5A28171.json</JsonFileName>
      <Type>1</Type>
      <Subprocess>0</Subprocess>
      <Category>6</Category>
      <Mode>0</Mode>
      <Scope>4</Scope>
      <OnDemand>0</OnDemand>
      <TriggerOnCreate>0</TriggerOnCreate>
      <TriggerOnDelete>0</TriggerOnDelete>
      <AsyncAutodelete>0</AsyncAutodelete>
      <SyncWorkflowLogOnFailure>0</SyncWorkflowLogOnFailure>
      <StateCode>1</StateCode>
      <StatusCode>2</StatusCode>
      <RunAs>1</RunAs>
      <IsTransacted>1</IsTransacted>
      <IntroducedVersion>1.0</IntroducedVersion>
      <IsCustomizable>1</IsCustomizable>
      <BusinessProcessType>0</BusinessProcessType>
      <UIFlowType>2</UIFlowType>
      <IsCustomProcessingStepAllowedForOtherPublishers>1</IsCustomProcessingStepAllowedForOtherPublishers>
      <Metadata>{"isvalid":true,"schemaVersion":"ROBIN_20211012","containsActiveConnections":false}</Metadata>
      <Inputs>{"schema":{"properties":{"Environment":{"default":"","description":"Holds environment specific values - DEV, QA, PROD","format":null,"title":"Environment","type":"string","value":"DEV"}},"type":"object"}}</Inputs>
      <Outputs>{"schema":{"properties":{"FileList":{"default":"","description":"","format":null,"title":"FileList","type":"string","value":null},"WOwithProblems":{"default":"","description":"","format":null,"title":"WOwithProblems","type":"string","value":null},"WOprocessedOK":{"default":"","description":"","format":null,"title":"WOprocessedOK","type":"string","value":null}},"type":"object"}}</Outputs>
      <Dependencies>{"childFlows":[]}</Dependencies>
      <ConnectionReferences>[]</ConnectionReferences>
      <Definition>"@@ConnectionString: ''\r\n@@Type: 'Local'\r\n@@DesktopType: 'local'\r\n@@DisplayName: 'Local computer'\r\nIMPORT 'controlRepo.appmask' AS appmask\r\nIMPORT 'imageRepo.imgrepo' AS imgrepo\r\n@SENSITIVE: []\r\n@INPUT Environment : { 'Description': 'Holds environment specific values - DEV, QA, PROD', 'FriendlyName': 'Environment', 'DefaultValue': 'DEV', 'Type': 'String' } \r\n@OUTPUT FileList : { 'Description': '', 'FriendlyName': 'FileList', 'Type': 'String' } \r\n@OUTPUT WOwithProblems : { 'Description': '', 'FriendlyName': 'WOwithProblems', 'Type': 'String' } \r\n@OUTPUT WOprocessedOK : { 'Description': '', 'FriendlyName': 'WOprocessedOK', 'Type': 'String' } \r\n# Main Task for Nova Archive Process\r\nBLOCK MainBlockErrorHandler\r\nON BLOCK ERROR all\r\n    SET ErrorHandlerMessage TO $'''Flow failed due to some error'''\r\n    CALL ErrorHandler\r\n    THROW ERROR\r\nEND\r\n    CALL Configuration\r\n    CALL LoopOverInputFiles\r\n    CALL SendEmailNotification\r\nEND\r\nDISABLE Display.ShowMessageDialog.ShowMessage Message: $'''Main flow''' Icon: Display.Icon.None Buttons: Display.Buttons.OK DefaultButton: Display.DefaultButton.Button1 IsTopMost: False ButtonPressed=&gt; ButtonPressed\r\nFUNCTION Configuration GLOBAL\r\n    SET Config_FolderPath TO $'''C:\\\\Users\\\\ds575852\\\\OneDrive - GSK\\\\Projects\\\\Power Automate\\\\PoC\\\\MSC_SCP_072_NovaArchive\\\\Folder Structure'''\r\n    SET WOprocessedOK TO $'''%%'''\r\n    SET WOwithProblems TO $'''%%'''\r\nEND FUNCTION\r\nFUNCTION ErrorHandler GLOBAL\r\n    DISABLE Display.ShowMessageDialog.ShowMessage Title: $'''ok''' Message: $'''Error Handler Started''' Icon: Display.Icon.None Buttons: Display.Buttons.OK DefaultButton: Display.DefaultButton.Button1 IsTopMost: False ButtonPressed=&gt; ButtonPressed\r\n    ERROR =&gt; LastError\r\nEND FUNCTION\r\nFUNCTION LoopOverInputFiles GLOBAL\r\n    IF (Folder.IfFolderExists.Exists Path: $'''%Config_FolderPath%\\\\Input''') THEN\r\n        Folder.GetFiles Folder: $'''%Config_FolderPath%\\\\Input''' FileFilter: $'''*.pdf''' IncludeSubfolders: False FailOnAccessDenied: True SortBy1: Folder.SortBy.NoSort SortDescending1: False SortBy2: Folder.SortBy.NoSort SortDescending2: False SortBy3: Folder.SortBy.NoSort SortDescending3: False Files=&gt; WorkOrderFiles\r\n        UIAutomation.CloseWindow.Close Window: appmask['Window \\'20210330085307.pdf - Profile 1 - Microsoft​ Edge\\'']\r\n                ON ERROR\r\n        \r\n                END\r\n        LOOP FOREACH WorkOrder IN WorkOrderFiles\r\n            # Trying to capture the PDF text using OCR actions\r\n            System.RunApplication.RunApplication ApplicationPath: $'''C:\\\\Program Files (x86)\\\\Microsoft\\\\Edge\\\\Application\\\\msedge.exe''' CommandLineArguments: $'''\\\"%WorkOrder%\\\"''' WindowStyle: System.ProcessWindowStyle.Maximized ProcessId=&gt; AppProcessId\r\n            WAIT (UIAutomation.WaitForWindowContent.WindowToContainElement Element: appmask['Window \\'20210330085307.pdf - Profile 1 - Microsoft​ Edge\\'']['Image \\'Unlabeled graphic\\''])\r\n            UIAutomation.Click Element: appmask['Window \\'20210330085307.pdf - Profile 1 - Microsoft​ Edge\\' 2']['Image'] ClickType: UIAutomation.ClickType.LeftClick MousePositionRelativeToElement: UIAutomation.RectangleEdgePoint.MiddleCenter OffsetX: 0 OffsetY: 0\r\n            OCR.ExtractTextWithOCR.ExtractTextFromRegionOfForegroundWindowWithWindowsOcr WindowsOcrLanguage: OCR.WindowsOcrLanguage.English ImageWidthMultiplier: 1 ImageHeightMultiplier: 1 X1: 0 X2: 1920 Y1: 150 Y2: 700 OcrText=&gt; OcrText\r\n            UIAutomation.CloseWindow.Close Window: appmask['Window \\'20210330085307.pdf - Profile 1 - Microsoft​ Edge\\'']\r\n            BLOCK OCRErrorHandler\r\nON BLOCK ERROR\r\nCALL EH_OCRissue\r\nEND\r\n                # OrderNo Extraction\r\n                Text.ParseText.RegexParseForFirstOccurrence Text: OcrText TextToFind: $'''No:(\\\\d*)''' StartingPosition: 0 IgnoreCase: True Match=&gt; OCR_OrderNo\r\n                Text.CropText.CropTextAfterFlag Text: OCR_OrderNo FromFlag: $'''No:''' IgnoreCase: True CroppedText=&gt; OCR_OrderNo\r\n                # Description Extraction\r\n                Text.ParseText.RegexParseForFirstOccurrence Text: OcrText TextToFind: $'''Description:(.*)\\\\n''' StartingPosition: 0 IgnoreCase: True Match=&gt; OCR_Description\r\n                Text.CropText.CropTextBetweenFlags Text: OCR_Description FromFlag: $'''Description:''' ToFlag: $'''Priority:''' IgnoreCase: True CroppedText=&gt; OCR_Description\r\n                # Start Date Extraction\r\n                Text.ParseText.RegexParseForFirstOccurrence Text: OcrText TextToFind: $'''Start Date:(.*)\\\\n''' StartingPosition: 0 IgnoreCase: True Match=&gt; OCR_StartDate\r\n                Text.Replace Text: OCR_StartDate TextToFind: $'''—''' IsRegEx: False IgnoreCase: False ReplaceWith: $'''-''' ActivateEscapeSequences: False Result=&gt; OCR_StartDate\r\n                Text.RecognizeEntitiesInText Text: OCR_StartDate Mode: Text.RecognizerMode.DateTime Language: Text.RecognizerLanguage.English RecognizedEntities=&gt; OCR_StartDate\r\n                Text.ConvertDateTimeToText.FromCustomDateTime DateTime: OCR_StartDate[0][0] CustomFormat: $'''yyyy-MM-dd''' Result=&gt; OCR_StartDate\r\n                Folder.Create FolderPath: $'''%Config_FolderPath%\\\\Output''' FolderName: OCR_OrderNo\r\n                                ON ERROR\r\n                \r\n                                END\r\n                File.Copy Files: WorkOrder Destination: $'''%Config_FolderPath%\\\\Output\\\\%OCR_OrderNo%''' IfFileExists: File.IfExists.DoNothing CopiedFiles=&gt; CopiedFiles\r\n                Text.GetSubtext.GetSubtextFromStartTo Text: OCR_OrderNo NumberOfChars: 3 Subtext=&gt; FirstThreeCharsOfWorkOrder\r\n                File.Copy Files: $'''%Config_FolderPath%\\\\Template\\\\WO Spreadsheet.XLSX''' Destination: $'''%Config_FolderPath%\\\\Output''' IfFileExists: File.IfExists.DoNothing CopiedFiles=&gt; CopiedFiles\r\n                File.RenameFiles.Rename Files: $'''%Config_FolderPath%\\\\Output\\\\WO Spreadsheet.XLSX''' NewName: $'''%FirstThreeCharsOfWorkOrder%00000.xlsx''' KeepExtension: False IfFileExists: File.IfExists.DoNothing\r\n                **REGION Create Excel Row\r\n                Variables.CreateNewDatatable InputTable: { ^['Column1', 'Column2', 'Column3', 'Column4', 'Column5', 'Column6', 'Column7'], [$'''''', $'''''', $'''''', $'''''', $'''''', $'''''', $''''''] } DataTable=&gt; Results\r\n                # Values are hardcoded for now as we donot have the details (in the requirement doc) what values should go into each columns.\r\n                Variables.AddRowToDataTable.AppendRowToDataTable DataTable: Results RowToAdd: ['ADT', 'GSK', 'GSK', 'GSK', 'GSK', 'GSK', 'GSK']\r\n                **ENDREGION\r\n                CALL ExcelOperations\r\n                CALL CreateINIFile\r\n                # Setting the output variables\r\n                Text.AppendLine Text: FileList LineToAppend: OCR_OrderNo Result=&gt; FileList\r\n                Text.AppendLine Text: WOprocessedOK LineToAppend: WorkOrder Result=&gt; WOprocessedOK\r\n            END\r\n        END\r\n    ELSE\r\n        EXIT Code: 0 ErrorMessage: $'''Input folder not found at %Config_FolderPath%'''\r\n    END\r\nEND FUNCTION\r\nFUNCTION CreateINIFile GLOBAL\r\n    DISABLE SET Config_FolderPath TO $'''C:\\\\Users\\\\ds575852\\\\OneDrive - GSK\\\\Projects\\\\Power Automate\\\\PoC\\\\MSC_SCP_072_NovaArchive\\\\Folder Structure'''\r\n    XML.ReadFromFile File: $'''%Config_FolderPath%\\\\Template\\\\WorkOrder.xml''' Encoding: XML.FileEncoding.DefaultEncoding XmlDocument=&gt; WorkOrderXmlDocument\r\n    XML.SetElementValue Document: WorkOrderXmlDocument XPathQuery: $'''/*[name()=\\'pierRecord\\' and namespace-uri()=\\'http://www.gsk.com/pier/schema/pier\\']/*[name()=\\'user\\']/*[name()=\\'submitterId\\']''' ElementValue: 111\r\n    XML.SetElementValue Document: WorkOrderXmlDocument XPathQuery: $'''/*[name()=\\'pierRecord\\' and namespace-uri()=\\'http://www.gsk.com/pier/schema/pier\\']/*[name()=\\'user\\']/*[name()=\\'submitterName\\']''' ElementValue: $'''ABC'''\r\n    XML.SetElementValue Document: WorkOrderXmlDocument XPathQuery: $'''/*[name()=\\'pierRecord\\' and namespace-uri()=\\'http://www.gsk.com/pier/schema/pier\\']/*[name()=\\'user\\']/*[name()=\\'title\\']''' ElementValue: $'''Work Order Desc'''\r\n    XML.SetElementValue Document: WorkOrderXmlDocument XPathQuery: $'''/*[name()=\\'pierRecord\\' and namespace-uri()=\\'http://www.gsk.com/pier/schema/pier\\']/*[name()=\\'user\\']/*[name()=\\'authors\\']/*[name()=\\'author\\']''' ElementValue: $'''XYZ_TEST'''\r\n    XML.SetElementValue Document: WorkOrderXmlDocument XPathQuery: $'''/*[name()=\\'pierRecord\\' and namespace-uri()=\\'http://www.gsk.com/pier/schema/pier\\']/*[name()=\\'user\\']/*[name()=\\'authorIds\\']/*[name()=\\'authorId\\']''' ElementValue: $'''exx11111'''\r\n    XML.SetElementAttribute Document: WorkOrderXmlDocument XPathQuery: $'''/*[name()=\\'pierRecord\\' and namespace-uri()=\\'http://www.gsk.com/pier/schema/pier\\']/*[name()=\\'user\\']/*[name()=\\'documents\\']/*[name()=\\'document\\']/*[name()=\\'file\\']''' AttributeName: $'''name''' AttributeValue: 123456789\r\n    XML.SetElementValue Document: WorkOrderXmlDocument XPathQuery: $'''/*[name()=\\'pierRecord\\' and namespace-uri()=\\'http://www.gsk.com/pier/schema/pier\\']/*[name()=\\'user\\']/*[name()=\\'issuedOn\\']''' ElementValue: $'''2023-05-15'''\r\n    XML.SetElementValue Document: WorkOrderXmlDocument XPathQuery: $'''/*[name()=\\'pierRecord\\' and namespace-uri()=\\'http://www.gsk.com/pier/schema/pier\\']/*[name()=\\'user\\']/*[name()=\\'lnbIssueDate\\']''' ElementValue: $'''2023-05-15'''\r\n    XML.WriteXmlToFile.WriteToFileFormatted File: $'''%Config_FolderPath%\\\\Output\\\\%OCR_OrderNo%\\\\%OCR_OrderNo%.ini''' Xml: WorkOrderXmlDocument Encoding: XML.FileEncoding.DefaultEncoding Indentation: 2\r\nEND FUNCTION\r\nFUNCTION ExcelOperations GLOBAL\r\n    Excel.LaunchExcel.LaunchAndOpenUnderExistingProcess Path: $'''%Config_FolderPath%\\\\Output\\\\%FirstThreeCharsOfWorkOrder%00000.xlsx''' Visible: True ReadOnly: False Instance=&gt; ExcelInstance\r\n    Excel.GetFirstFreeRowOnColumn Instance: ExcelInstance Column: 4 FirstFreeRowOnColumn=&gt; FirstFreeRowOnColumn\r\n    DISABLE Excel.WriteToExcel.WriteCell Instance: ExcelInstance Value: $'''ADA-TST-WTG_WO''' Column: 3 Row: FirstFreeRowOnColumn\r\n    Excel.WriteToExcel.WriteCell Instance: ExcelInstance Value: Results Column: 3 Row: FirstFreeRowOnColumn\r\n    Excel.CloseExcel.CloseAndSave Instance: ExcelInstance\r\nEND FUNCTION\r\nFUNCTION EH_OCRissue GLOBAL\r\n    Text.AppendLine Text: WOwithProblems LineToAppend: WorkOrder Result=&gt; WOwithProblems\r\nEND FUNCTION\r\nFUNCTION SendEmailNotification GLOBAL\r\n    SET EmailMessage TO $'''Work orders processed OK: %WOprocessedOK%\r\n\r\nWork orders with problems:\r\n%WOwithProblems%'''\r\n    Outlook.Launch Instance=&gt; OutlookInstance\r\n    Outlook.SendEmailThroughOutlook.SendEmail Instance: OutlookInstance Account: $'''dipendra.x.shekhawat@gsk.com''' SendTo: $'''dipendra.x.shekhawat@gsk.com''' Subject: $'''3021 - Nova Archive Work Order Completion Summary''' Body: $'''Hi Team,\r\n\r\n%EmailMessage%\r\n\r\nRegards\r\nRPA Bot''' IsBodyHtml: False\r\n    Outlook.Close Instance: OutlookInstance\r\nEND FUNCTION\r\n"</Definition>
      <SchemaVersion>2022.06</SchemaVersion>
      <PrimaryEntity>none</PrimaryEntity>
      <LocalizedNames>
        <LocalizedName languagecode="1033" description="RPA-3021-NovaArchive" />
      </LocalizedNames>
    </Workflow>
    <Workflow WorkflowId="{91fa6b6a-2ce4-ed11-a7c7-6045bd0261b8}" Name="RPA-3021-Schedule">
      <JsonFileName>/Workflows/RPA-3021-Schedule-91FA6B6A-2CE4-ED11-A7C7-6045BD0261B8.json</JsonFileName>
      <Type>1</Type>
      <Subprocess>0</Subprocess>
      <Category>5</Category>
      <Mode>0</Mode>
      <Scope>4</Scope>
      <OnDemand>0</OnDemand>
      <TriggerOnCreate>0</TriggerOnCreate>
      <TriggerOnDelete>0</TriggerOnDelete>
      <AsyncAutodelete>0</AsyncAutodelete>
      <SyncWorkflowLogOnFailure>0</SyncWorkflowLogOnFailure>
      <StateCode>0</StateCode>
      <StatusCode>1</StatusCode>
      <RunAs>1</RunAs>
      <IsTransacted>1</IsTransacted>
      <IntroducedVersion>1.0.0.0</IntroducedVersion>
      <IsCustomizable>1</IsCustomizable>
      <BusinessProcessType>0</BusinessProcessType>
      <IsCustomProcessingStepAllowedForOtherPublishers>1</IsCustomProcessingStepAllowedForOtherPublishers>
      <PrimaryEntity>none</PrimaryEntity>
      <LocalizedNames>
        <LocalizedName languagecode="1033" description="RPA-3021-Schedule" />
      </LocalizedNames>
    </Workflow>
    <Workflow WorkflowId="{15f2197c-2fe4-ed11-a7c7-6045bd0261b8}" Name="RPA-710-Scheduler">
      <JsonFileName>/Workflows/RPA-710-Scheduler-15F2197C-2FE4-ED11-A7C7-6045BD0261B8.json</JsonFileName>
      <Type>1</Type>
      <Subprocess>0</Subprocess>
      <Category>5</Category>
      <Mode>0</Mode>
      <Scope>4</Scope>
      <OnDemand>0</OnDemand>
      <TriggerOnCreate>0</TriggerOnCreate>
      <TriggerOnDelete>0</TriggerOnDelete>
      <AsyncAutodelete>0</AsyncAutodelete>
      <SyncWorkflowLogOnFailure>0</SyncWorkflowLogOnFailure>
      <StateCode>0</StateCode>
      <StatusCode>1</StatusCode>
      <RunAs>1</RunAs>
      <IsTransacted>1</IsTransacted>
      <IntroducedVersion>1.0.0.0</IntroducedVersion>
      <IsCustomizable>1</IsCustomizable>
      <BusinessProcessType>0</BusinessProcessType>
      <IsCustomProcessingStepAllowedForOtherPublishers>1</IsCustomProcessingStepAllowedForOtherPublishers>
      <PrimaryEntity>none</PrimaryEntity>
      <LocalizedNames>
        <LocalizedName languagecode="1033" description="RPA-710-Scheduler" />
      </LocalizedNames>
    </Workflow>
  </Workflows>
  <FieldSecurityProfiles></FieldSecurityProfiles>
  <Templates />
  <EntityMaps />
  <EntityRelationships />
  <OrganizationSettings />
  <optionsets />
  <CustomControls />
  <EntityDataProviders />
  <connectionreferences>
    <connectionreference connectionreferencelogicalname="gskrpa_sharedoffice365_456b3">
      <connectionreferencedisplayname>Office 365 Outlook RPAPOC-456b3</connectionreferencedisplayname>
      <connectorid>/providers/Microsoft.PowerApps/apis/shared_office365</connectorid>
      <iscustomizable>1</iscustomizable>
      <statecode>0</statecode>
      <statuscode>1</statuscode>
    </connectionreference>
    <connectionreference connectionreferencelogicalname="gskrpa_shareduiflow_ac275">
      <connectionreferencedisplayname>Desktop flows RPAPOC-ac275</connectionreferencedisplayname>
      <connectorid>/providers/Microsoft.PowerApps/apis/shared_uiflow</connectorid>
      <iscustomizable>1</iscustomizable>
      <statecode>0</statecode>
      <statuscode>1</statuscode>
    </connectionreference>
  </connectionreferences>
  <Languages>
    <Language>1033</Language>
  </Languages>
</ImportExportXml>